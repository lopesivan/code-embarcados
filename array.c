#include "array.h"

struct Array_t{
    unsigned int size;
    array_t      data;
};

/*****************************************************************************
 *                                                                           *
 * ------------------------------ createArray ------------------------------ *
 *                                                                           *
 *****************************************************************************/

Array createArray(Size size)
{
    Array array = malloc(sizeof *array);

    if is_null(array) {
        printf("%s:In function `%s':\n" "%s:%d: %s\n", \
           __FILE__, __FUNCTION__, __FILE__, __LINE__, \
           "could not allocate the Array pointer"
        );

        exit(EXIT_FAILURE);
    }

    array->size   = size;
    array->data   = new_array(size);

    if is_null(array->data)
    {
        printf("%s:In function `%s':\n" "%s:%d: %s\n",\
           __FILE__, __FUNCTION__, __FILE__,  __LINE__,\
           "could not allocate Array data"
        );

        exit(EXIT_FAILURE);
    }

    return array;
}
/*****************************************************************************
 *                                                                           *
 * ------------------------- createArrayWithDataNu ------------------------- *
 *                                                                           *
 *****************************************************************************/

Array createArrayWithDataNull(Size size)
{
    Array array = malloc(sizeof *array);

    if is_null(array) {
        printf("%s:In function `%s':\n" "%s:%d: %s\n", \
           __FILE__, __FUNCTION__, __FILE__, __LINE__, \
           "could not allocate the Array pointer"
        );

        exit(EXIT_FAILURE);
    }

    array->size   = size;
    array->data   = NULL;

    return array;
}

/*****************************************************************************
 *                                                                           *
 * ------------------------------ destroyArray ----------------------------- *
 *                                                                           *
 *****************************************************************************/

void destroyArray(Array array)
{
    free(array->data);
    free(array);

    return;
}

/*****************************************************************************
 *                                                                           *
 * ------------------------------- zeroArray ------------------------------- *
 *                                                                           *
 *****************************************************************************/

void zeroArray(Array array)
{
    zero(array->data, array->size);

    return;
}

/*****************************************************************************
 *                                                                           *
 * ------------------------------- printArray ------------------------------ *
 *                                                                           *
 *****************************************************************************/

void printArray(Array array)
{
    print_array(array->data, array->size);

    return;
}

/*****************************************************************************
 *                                                                           *
 * -------------------------------- oneArray ------------------------------- *
 *                                                                           *
 *****************************************************************************/

void oneArray(Array array)
{
    one(array->data, array->size);

    return;
}

/*****************************************************************************
 *                                                                           *
 * -------------------------------- twoArray ------------------------------- *
 *                                                                           *
 *****************************************************************************/

void twoArray(Array array)
{
    two(array->data, array->size);

    return;
}

/*****************************************************************************
 *                                                                           *
 * ------------------------------- threeArray ------------------------------ *
 *                                                                           *
 *****************************************************************************/

void threeArray(Array array)
{
    three(array->data, array->size);

    return;
}

/*****************************************************************************
 *                                                                           *
 * ------------------------------- randArray ------------------------------- *
 *                                                                           *
 *****************************************************************************/

void randArray(Array array)
{
    grand(array->data, array->size);

    return;
}

/*****************************************************************************
 *                                                                           *
 * -------------------------------- sumArray ------------------------------- *
 *                                                                           *
 *****************************************************************************/

Scalar sumArray(Array array)
{
    return sum(array->data, array->size);
}

/*****************************************************************************
 *                                                                           *
 * ------------------------------ seq_sumArray ----------------------------- *
 *                                                                           *
 *****************************************************************************/

Scalar seq_sumArray(Array array,
                    Scalar (*f)(Scalar))
{
    return seq_sum(array->data, 0, array->size, f);
}

/*****************************************************************************
 *                                                                           *
 * ---------------------------- seq_productArray --------------------------- *
 *                                                                           *
 *****************************************************************************/

Scalar seq_productArray(Array array,
                        Scalar (*f)(Scalar))
{
    return seq_product(array->data, 0, array->size, f);
}

/*****************************************************************************
 *                                                                           *
 * -------------------------------- mapArray ------------------------------- *
 *                                                                           *
 *****************************************************************************/

void mapArray (Array array, Scalar (*f)(Scalar))
{
    unsigned int i;

    for (i = 0; i < array->size; i++)
        array->data[i] = f(array->data[i])
    ;

    return;
}

/*****************************************************************************
 *                                                                           *
 * ---------------------------------- Dot ---------------------------------- *
 *                                                                           *
 *****************************************************************************/

Scalar Dot(Array a,
           Array b)
{
    if (a->size != b->size)
    {
        printf("%s:In function `%s':\n" "%s:%d: %s\n", \
           __FILE__, __FUNCTION__, __FILE__, __LINE__, \
           "Vectors of different sizes"
        );

        exit(EXIT_FAILURE);
    }

    return dot(a->data, b->data, a->size);
}

/*****************************************************************************
 *                                                                           *
 * ------------------------------ productArray ----------------------------- *
 *                                                                           *
 *****************************************************************************/

Scalar productArray(Array array)
{
    return product(array->data, array->size);
}

/*****************************************************************************
 *                                                                           *
 * ---------------------------------- Mul ---------------------------------- *
 *                                                                           *
 *****************************************************************************/

Array Mul(Array a,
             Array b)
{

    if (a->size != b->size)
    {
        printf("%s:In function `%s':\n" "%s:%d: %s\n", \
           __FILE__, __FUNCTION__, __FILE__, __LINE__, \
           "Vectors of different sizes"
        );

        exit(EXIT_FAILURE);
    }

    Array c = createArray(a->size);

    array_dot(a->data, b->data, c->data, a->size);

    return c;
}

/*****************************************************************************
 *                                                                           *
 * ---------------------------------- Add ---------------------------------- *
 *                                                                           *
 *****************************************************************************/

Array Add(Array a,
             Array b)
{

    if (a->size != b->size)
    {
        printf("%s:In function `%s':\n" "%s:%d: %s\n", \
           __FILE__, __FUNCTION__, __FILE__, __LINE__, \
           "Vectors of different sizes"
        );

        exit(EXIT_FAILURE);
    }

    Array c = createArray(a->size);

    array_add(a->data, b->data, c->data, a->size);

    return c;
}

/*****************************************************************************
 *                                                                           *
 * ------------------------------ reverseArray ----------------------------- *
 *                                                                           *
 *****************************************************************************/

void reverseArray(Array array)
{
    array_reverse(array->data, array->size);

    return;
}

/*****************************************************************************
 *                                                                           *
 * -------------------------------- getData -------------------------------- *
 *                                                                           *
 *****************************************************************************/

array_t getData  ( Array array )
{
    return array->data;
}

/*****************************************************************************
 *                                                                           *
 * -------------------------------- getSize -------------------------------- *
 *                                                                           *
 *****************************************************************************/

Size getSize  ( Array array )
{
    return array->size;
}

void toarray(Array array, array_t data)
{
    array->data = data;

    return;
}
